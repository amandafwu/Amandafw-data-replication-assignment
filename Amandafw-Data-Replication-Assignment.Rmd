---
title: "data-replication-assignment"
author: "Amanda Wu"
date: "2023-11-08"
output: html_document
---


Here is a list of packages I've downloaded for this replication project. 
```{r packages}
library(readr)
library(curl)
library(tidyverse)
library(dplyr)
# these packages were mentioned within the paper for their statistical analysis 
library(stats)
library(ggplot2)
library(ggeffects)
```

```{r uploading data}
# uploading the camera trap data from 2019 - 2020 for predator activity within the landscape analysis
f <- curl("https://raw.githubusercontent.com/amandafwu/Amandafw-data-replication-assignment/main/camera_trap_data_2019_2020.csv") 
camera_trap_data <- read.csv(f, header = TRUE, sep = ",")
head(camera_trap_data)

f <- curl("https://raw.githubusercontent.com/amandafwu/Amandafw-data-replication-assignment/main/camera_trap_data_flowerstrips_1m.csv") 
flowerstrips1m <- read.csv(f, header = TRUE, sep = ",")
head(flowerstrips1m)

f <- curl("https://raw.githubusercontent.com/amandafwu/Amandafw-data-replication-assignment/main/camera_trap_data_flowerstrips_all.csv") 
flowerstripsALL <- read.csv(f, header = TRUE, sep = ",")
head(flowerstripsALL)
```
Performing a Kruskal-Wallis Test to determine 
```{r Kruskal-Wallis Test}
library("ggpubr")

group_by(camera_trap_data, Vegetation) %>%
  summarise(
    count = n(),
    mean = mean(allpredators_without_dogs_100, na.rm = TRUE),
    sd = sd(allpredators_without_dogs_100, na.rm = TRUE),
    confint_lower = t.test(allpredators_without_dogs_100, na.rm = TRUE)$conf.int[1],
    confint_upper = t.test(allpredators_without_dogs_100, na.rm = TRUE)$conf.int[2],
    CI_width = ( confint_upper - confint_lower ) / 2
  )


kruskal.test(allpredators_without_dogs_100 ~ Vegetation, data = camera_trap_data)
```

This is my replication of Figure 3 from the paper, showing mean capture rates of all predators in different vegetation types. 

![]("Users/amandawu/Desktop/AN588/Figure3.png")

```{r Figure 3}
p <- ggplot(camera_trap_data, aes(x=reorder(Vegetation, allpredators_without_dogs_100, FUN = mean), y=allpredators_without_dogs_100)) + 
  stat_summary(geom = "point", fun.y = mean, shape = 15, size = 2) +
  ylab("captures/100 days") +
  xlab("vegetation type") +
  stat_summary(fun.data = "mean_sdl", fun.args = list(mult = .3), geom = "errorbar", width = 0.15) +
  scale_x_discrete(labels = c("G" = "winter cereal", "B" = "flower strip", "E" = "field margin", "R" = "rapeseed", "H" = "hedge")) +
  theme(axis.title = element_text(face = "bold"))
p

```


```{r finding mean}
my_data <- as_tibble(camera_trap_data)
predator <- my_data %>% select(25:33)
predator

colnames(predator)
names <- predator %>% 
  rename(
    Badger = badger_100,
    Boar = boar_100,
    Cat = cats_100,
    Dog = dog_100,
    Fox = fox_100,
    Marten = marten_100,
    MouseWeasel = mouseweasel_100,
    Racoon = racoon_100,
    Stoat = stoat_100
  )
colnames(names)
long <- names %>%
  gather(Predator, Captures)


p <- ggplot(long, aes(reorder(Predator, Captures), Captures)) +
  stat_summary(geom = "point", fun.y = mean) +
  ylab("captures/100 days") +
  xlab("Predator Species") +
  expand_limits(y = c(0,30)) 

p  

sd(predator$badger_100)
mean(predator$badger_100)



head(predator)
class(predator$badger_100)
class(long$Captures)
predator

```

```{r Shapiro Wilk}
shapiro.test(camera_trap_data$allpredators_without_dogs_100)
shapiro.test(camera_trap_data$badger_100)
shapiro.test(camera_trap_data$boar_100)
shapiro.test(camera_trap_data$cats_100)
shapiro.test(camera_trap_data$dog_100)
shapiro.test(camera_trap_data$fox_100)
shapiro.test(camera_trap_data$marten_100)
shapiro.test(camera_trap_data$mouseweasel_100)
shapiro.test(camera_trap_data$racoon_100)
shapiro.test(camera_trap_data$stoat_100)

my_data <- as_tibble(camera_trap_data)
predator <- my_data %>% select(25:33)
predator
lshap <- lapply(predator, shapiro.test)
lshap[[1]] ## look at the first column results
lres <- sapply(lshap, `[`, c("statistic","p.value"))
as.table(lres)
```


```{r option 2}
mean(camera_trap_data$badger_100)
mean(camera_trap_data$boar_100)
mean(camera_trap_data$cats_100)
mean(camera_trap_data$dog_100)
mean(camera_trap_data$fox_100)

sd(camera_trap_data$badger_100)
sd(camera_trap_data$boar_100)
sd(camera_trap_data$cats_100)
sd(camera_trap_data$dog_100)
sd(camera_trap_data$fox_100)

df<-data.frame(Mean=c(5.625308,3.671263,0.7387124,1.68524,18.81459), 
               sd=c(16.01608,12.26168,2.974136,11.86392,50.4956), 
               Quality=as.factor(c("Badger","Boar","Cat", 
                                   "Dog","Fox")),  
               Category=c("Badger","Boar","Cat", 
                                   "Dog","Fox"), 
               Insert= c(0.0, 0.1, 0.3, 0.5, 1.0))

p<-ggplot(df, aes(x=Category, y=Mean, fill=Quality)) +  
  geom_point()+ 
  geom_errorbar(aes(ymin=Mean-sd, ymax=Mean+sd), width=.2, 
                position=position_dodge(0.05)) 
  
p
```


```{r GLMM}
m0 <- lm(data = camera_trap_data, allpredators_100 ~ 1)
summary(m0)
add1(m0, scope = . ~ . + Grass_Area_500m + Forest_Area_500m, test = "F")
```

## Sources: 
  + [how to reorder the x-axis](https://stackoverflow.com/questions/3744178/ggplot2-sorting-a-plot)
  + [renaming columns](https://www.datanovia.com/en/lessons/rename-data-frame-columns-in-r/)
  + [plotting average values of certain columns in ggplot](https://stackoverflow.com/questions/58415083/plotting-average-values-from-multiple-columns-in-ggplot2)
  + [backup option](https://www.geeksforgeeks.org/plot-mean-and-standard-deviation-using-ggplot2-in-r/)
